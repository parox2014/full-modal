"use strict";function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function i(i,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}return function(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}}();!function(i,t){function n(i){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=void 0;return function(){window.clearTimeout(n),n=setTimeout(i.bind(this),t)}}function e(){return""+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fm_")+ ++i.__UID__}function o(i){return"string"==typeof i}function s(i,t){var n={};return["webkit","moz","ms","o"].forEach(function(e){n["-"+e+"-"+i]=t}),n}if(!t)throw new Error("请先加载jquery");var a=new Map,l=[];i.__UID__=0;var r=void 0,c={BEFORE_OPEN:"BEFORE_OPEN",BEFORE_CLOSE:"BEFORE_CLOSE",AFTER_OPEN:"AFTER_OPEN",AFTER_CLOSE:"AFTER_CLOSE"},u=i.parent||i,h=location.origin.indexOf("http")>-1?location.origin:"*";l.hasOpenedModal=function(){for(var i=0;i<this.length;i++){var t=this[i];if(console.log(t),t.isOpen)return!0}return!1};var d=function(){function i(n,e){if(_classCallCheck(this,i),r instanceof i)return r;this.isOpen=!1,this.duration=e,this.container=t(n),this.initialize()}return _createClass(i,[{key:"initialize",value:function(){var i=this.$el=t('<div class="ibs-backdrop"></div>');this.container.append(i),i.on("click",function(){l.forEach(function(i){i.option.closeWhenClickBackdrop&&i.close()})})}},{key:"open",value:function(){this.$el.fadeIn(this.duration),this.isOpen=!0}},{key:"close",value:function(){l.filter(function(i){return i.isOpen}).length>1||(this.$el.fadeOut(this.duration),this.isOpen=!1)}}]),i}(),f=function(){function i(t,n){_classCallCheck(this,i),this.$el=t,this.option=n,this.$modalEl=this.$el.find(".ibs-full-modal"),this.$modalBody=this.$el.find(".ibs-modal-body"),this.isOpen=!1,this.isActivated=!1,this.isClosing=!1,this.backdrop=r=new d("body",n.duration+200),this.initialize()}return _createClass(i,[{key:"initialize",value:function(){var i=this;this.option.closeWhenClickBackdrop&&this.$el.on("click",function(){return i.onCloseButtonClick()}),this.$modalEl.on("click",function(i){return i.stopPropagation()}).on("click",".ibs-btn-close",function(){return i.onCloseButtonClick()}),this.$modalEl.css(s("transition","all "+this.option.duration+"ms")),this.setHeightWithWindowInnerHeight(),window.addEventListener("resize",n(this.setHeightWithWindowInnerHeight).bind(this))}},{key:"setHeightWithWindowInnerHeight",value:function(){var i=window.innerHeight;this.$el.height(i)}},{key:"open",value:function(){var i=this;this.option.beforeOpen.call(this,function(){u.postMessage(c.BEFORE_OPEN,h),i.activate(),i.backdrop.open(),i.$el.show(),i.$modalEl.animate({background:"#fff"},i.option.duration,function(){t("body").addClass("full-modal-open"),i.option.afterOpen.call(i),u.postMessage(c.AFTER_OPEN,h)}).css(s("transform","translateX(0)")).css({opacity:1}),i.isOpen=!0})}},{key:"scrollTop",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$modalBody.scrollTop(i)}},{key:"onCloseButtonClick",value:function(){this.isClosing||(this.isClosing=!0,this.option.beforeClose.call(this,this.close.bind(this)))}},{key:"close",value:function(){var i=this;this.isClosing=!1,u.postMessage(c.BEFORE_CLOSE,h),this.backdrop.close(),this.$modalEl.animate({background:"transparent"},this.option.duration,function(){l.hasOpenedModal()||t("body").removeClass("full-modal-open"),i.option.afterClose.call(i),u.postMessage(c.AFTER_CLOSE,h),i.$el.hide(),i.deactivate()}).css(s("transform","translateX(30%)")).css({opacity:0}),this.isOpen=!1}},{key:"activate",value:function(){var i=this;l.forEach(function(t){t===i?(t.isActivated=!0,t.$el.css({zIndex:102})):(t.isActivated=!1,t.$el.css({zIndex:101}))})}},{key:"deactivate",value:function(){this.isActivated=!1,this.$el.css({zIndex:101})}}]),i}(),p=["open","close","scrollTop"],v={duration:300,trigger:"",closeWhenClickBackdrop:!0,beforeOpen:function(i){i()},beforeClose:function(i){i()},afterOpen:t.noop,afterClose:t.noop};t.fn.fullModal=function(i){for(var n=arguments.length,s=Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return this.each(function(){var n=t(this);if(o(i)){var r=n.data("uniqueId"),c=a.get(r),u=i;return c?p.indexOf(u)<0?console.error('method:"'+u+'" is not allowed invoke on modal instance,expected method are ['+p.toString()+"]"):c[u].apply(c,s):console.error("please initialize modal first")}var h=t.extend({},v,i),d=e(),E=new f(n,h);n.data("uniqueId",d),a.set(d,E),l.push(E),h.trigger&&t(h.trigger).on("click",function(){E.open()})})},t.fn.fullModal.Events=c,t.fn.fullModal.Defaults=v}(window,jQuery);
//# sourceMappingURL=jquery.plugin.full-modal.min.js.map
