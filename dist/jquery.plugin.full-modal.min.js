"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,n,e){return n&&t(i.prototype,n),e&&t(i,e),i}}();!function(t,i){function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=void 0;return function(){window.clearTimeout(n),n=setTimeout(t.bind(this),i)}}function e(){return""+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fm_")+ ++t.__UID__}function o(t){return"string"==typeof t}function s(t,i){var n={};return["webkit","moz","ms","o"].forEach(function(e){n["-"+e+"-"+t]=i}),n}if(!i)throw new Error("请先加载jquery");var a=new Map,l=[];t.__UID__=0;var r=void 0,c={BEFORE_OPEN:"BEFORE_OPEN",BEFORE_CLOSE:"BEFORE_CLOSE",AFTER_OPEN:"AFTER_OPEN",AFTER_CLOSE:"AFTER_CLOSE"},u=t.parent||t;l.hasOpenedModal=function(){for(var t=0;t<this.length;t++){var i=this[t];if(console.log(i),i.isOpen)return!0}return!1};var h=function(){function t(n,e){if(_classCallCheck(this,t),r instanceof t)return r;this.isOpen=!1,this.duration=e,this.container=i(n),this.initialize()}return _createClass(t,[{key:"initialize",value:function(){var t=this.$el=i('<div class="ibs-backdrop"></div>');this.container.append(t),t.on("click",function(){l.forEach(function(t){t.option.closeWhenClickBackdrop&&t.close()})})}},{key:"open",value:function(){this.$el.fadeIn(this.duration),this.isOpen=!0}},{key:"close",value:function(){l.filter(function(t){return t.isOpen}).length>1||(this.$el.fadeOut(this.duration),this.isOpen=!1)}}]),t}(),d=function(){function t(i,n){_classCallCheck(this,t),this.$el=i,this.option=n,this.$modalEl=this.$el.find(".ibs-full-modal"),this.$modalBody=this.$el.find(".ibs-modal-body"),this.isOpen=!1,this.isActivated=!1,this.isClosing=!1,this.backdrop=r=new h("body",n.duration+200),this.initialize()}return _createClass(t,[{key:"initialize",value:function(){var t=this;this.option.closeWhenClickBackdrop&&this.$el.on("click",function(){return t.onCloseButtonClick()}),this.$modalEl.on("click",function(t){return t.stopPropagation()}).on("click",".ibs-btn-close",function(){return t.onCloseButtonClick()}),this.$modalEl.css(s("transition","all "+this.option.duration+"ms")),this.setHeightWithWindowInnerHeight(),window.addEventListener("resize",n(this.setHeightWithWindowInnerHeight).bind(this))}},{key:"setHeightWithWindowInnerHeight",value:function(){var t=window.innerHeight;this.$el.height(t)}},{key:"open",value:function(){var t=this;this.option.beforeOpen.call(this,function(){u.postMessage(c.BEFORE_OPEN,"*"),t.activate(),t.backdrop.open(),t.$el.show(),t.$modalEl.animate({background:"#fff"},t.option.duration,function(){i("body").addClass("full-modal-open"),t.option.afterOpen.call(t),u.postMessage(c.AFTER_OPEN,"*")}).css(s("transform","translateX(0)")).css({opacity:1}),t.isOpen=!0})}},{key:"scrollTop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$modalBody.scrollTop(t)}},{key:"onCloseButtonClick",value:function(){this.isClosing||(this.isClosing=!0,this.option.beforeClose.call(this,this.close.bind(this)))}},{key:"close",value:function(){var t=this;this.isClosing=!1,u.postMessage(c.BEFORE_CLOSE,"*"),this.backdrop.close(),this.$modalEl.animate({background:"transparent"},this.option.duration,function(){l.hasOpenedModal()||i("body").removeClass("full-modal-open"),t.option.afterClose.call(t),u.postMessage(c.AFTER_CLOSE,"*"),t.$el.hide(),t.deactivate()}).css(s("transform","translateX(30%)")).css({opacity:0}),this.isOpen=!1}},{key:"activate",value:function(){var t=this;l.forEach(function(i){i===t?(i.isActivated=!0,i.$el.css({zIndex:102})):(i.isActivated=!1,i.$el.css({zIndex:101}))})}},{key:"deactivate",value:function(){this.isActivated=!1,this.$el.css({zIndex:101})}}]),t}(),f=["open","close","scrollTop"],p={duration:300,trigger:"",closeWhenClickBackdrop:!0,beforeOpen:function(t){t()},beforeClose:function(t){t()},afterOpen:i.noop,afterClose:i.noop};i.fn.fullModal=function(t){for(var n=arguments.length,s=Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return this.each(function(){var n=i(this);if(o(t)){var r=n.data("uniqueId"),c=a.get(r),u=t;return c?f.indexOf(u)<0?console.error('method:"'+u+'" is not allowed invoke on modal instance,expected method are ['+f.toString()+"]"):c[u].apply(c,s):console.error("please initialize modal first")}var h=i.extend({},p,t),v=e(),E=new d(n,h);n.data("uniqueId",v),a.set(v,E),l.push(E),h.trigger&&i(h.trigger).on("click",function(){E.open()})})},i.fn.fullModal.Events=c,i.fn.fullModal.Defaults=p}(window,jQuery);
//# sourceMappingURL=jquery.plugin.full-modal.min.js.map
